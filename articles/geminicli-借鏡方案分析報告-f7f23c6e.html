<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="GeminiCli 借鏡方案分析報告">
  <title>GeminiCli 借鏡方案分析報告 | 知識庫</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="reading-progress" id="readingProgress"></div>
  <header>
    <div class="container">
      <a href="../" class="logo">知識庫</a>
      <nav>
        <a href="../#buddhism">佛學</a>
        <a href="../#thinking">思維方法</a>
        <a href="../#ai">AI技術</a>
        <a href="../#claude">Claude Code</a>
        <a href="../#game">遊戲</a>
      </nav>
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="切換深色模式">
        <span class="theme-icon">&#9680;</span>
      </button>
    </div>
  </header>

  <main class="container">
    <article>
      <div class="article-header">
        <span class="category-badge category-claude">Claude Code</span>
        <h1>GeminiCli 借鏡方案分析報告</h1>
        <div class="article-meta">
          <span class="date">2026-02-17</span>
          <div class="tags"><span class="tag">架構優化</span><span class="tag">GeminiCli</span><span class="tag">分析報告</span><span class="tag">系統設計</span><span class="tag">daily-digest-prompt</span><span class="tag">Circuit Breaker</span><span class="tag">錯誤分類</span><span class="tag">分散式追蹤</span></div>
        </div>
      </div>

      <details class="article-toc" open>
        <summary>目錄</summary>
        <ol>
          <li><a href="#執行摘要">執行摘要</a></li><li><a href="#一-方案與現實狀況的一致性分析">一、方案與現實狀況的一致性分析</a></li>  <li><a href="#高度準確的問題識別-5-5-項">✅ 高度準確的問題識別（5/5 項）</a></li>  <li><a href="#架構契合度驗證">🎯 架構契合度驗證</a></li><li><a href="#二-計畫的可行性評估">二、計畫的可行性評估</a></li>  <li><a href="#技術可行性-5-5">技術可行性：⭐⭐⭐⭐⭐（5/5）</a></li>  <li><a href="#依賴關係圖準確性-5-5">依賴關係圖準確性：⭐⭐⭐⭐⭐（5/5）</a></li>  <li><a href="#修改範圍評估">修改範圍評估</a></li><li><a href="#三-落實的價值分析">三、落實的價值分析</a></li>  <li><a href="#價值矩陣-影響力-緊迫性-roi">價值矩陣（影響力 × 緊迫性 × ROI）</a></li>  <li><a href="#價值詳細分析">價值詳細分析</a></li><li><a href="#四-推薦實施路線圖">四、推薦實施路線圖</a></li>  <li><a href="#phase-1-立即行動-2-週內完成">🚀 Phase 1（立即行動，2 週內完成）</a></li>  <li><a href="#phase-2-需求驅動-3-6-個月內">🔄 Phase 2（需求驅動，3-6 個月內）</a></li><li><a href="#五-風險與緩解措施">五、風險與緩解措施</a></li>  <li><a href="#已識別風險">已識別風險</a></li>  <li><a href="#實施前置條件">實施前置條件</a></li><li><a href="#六-結論與建議">六、結論與建議</a></li>  <li><a href="#綜合評分">綜合評分</a></li>  <li><a href="#最終建議">最終建議</a></li>  <li><a href="#修正建議">修正建議</a></li><li><a href="#附錄-參考資料">附錄：參考資料</a></li>
        </ol>
      </details>

      <div class="article-content">
        <h1>GeminiCli 借鏡方案分析報告</h1>
<h2 id="執行摘要">執行摘要</h2>
<p>GeminiCli 借鏡方案是一份高品質的架構優化計畫，準確識別了本專案的 5 個關鍵痛點，並從 google-gemini/gemini-cli（94.6k stars）借鏡 6 個成熟設計模式。整體方案<strong>與現實狀況高度一致</strong>（95% 準確度），<strong>技術可行性極高</strong>（無新依賴），<strong>價值顯著但優先順序需調整</strong>。</p>
<p><strong>推薦行動</strong>：立即實施項目 1（分散式追蹤）、項目 2（錯誤分類）、項目 3（Schema 驗證）；延後項目 4-6 直到痛點顯現。</p>
<hr>
<h2 id="一-方案與現實狀況的一致性分析">一、方案與現實狀況的一致性分析</h2>
<h3 id="高度準確的問題識別-5-5-項">✅ 高度準確的問題識別（5/5 項）</h3>
<table>
<tr><th>問題陳述</th><th>現實驗證</th><th>準確度</th></tr>
<tr><td><strong>錯誤處理盲區</strong>：只有 <code>$LASTEXITCODE + 固定延遲重試</code></td><td>✅ 確認：所有 <code>run-*.ps1</code> 腳本只檢查退出碼，無 HTTP 狀態碼分類</td><td>100%</td></tr>
<tr><td><strong>無分散式追蹤</strong>：Team 模式 5 個 Agent 寫同一 JSONL，無法關聯</td><td>⚠️ 部分準確：已有 Phase 標記（phase1/phase2），但缺跨 session 的 trace_id</td><td>80%</td></tr>
<tr><td><strong>配置驗證不完整</strong>：validate_config.py 只覆蓋 7/13 個 YAML</td><td>⚠️ 數字有誤：實際覆蓋 12/15 個 YAML（missing: retro-games, creative-game-mode, digest-format.md）</td><td>80%</td></tr>
<tr><td><strong>無迴圈偵測</strong>：Agent 可能重複呼叫相同 API 或陷入循環</td><td>✅ 確認：無任何迴圈檢測機制（research-registry.json 僅做跨 session 主題去重）</td><td>100%</td></tr>
<tr><td><strong>安全規則扁平化</strong>：hook-rules.yaml 所有規則同等權重</td><td>✅ 確認：無 priority 欄位、無 presets、無環境區分</td><td>100%</td></tr>
</table>
<p><strong>綜合評分</strong>：<strong>95/100</strong> — 問題識別極為精準，僅配置驗證覆蓋率數字有輕微誤差。</p>
<h3 id="架構契合度驗證">🎯 架構契合度驗證</h3>
<p>方案所有技術選型（Python hooks + PowerShell orchestration + YAML configs）完美契合現有架構：</p>
<ul>
<li>✅ <strong>無新 runtime 依賴</strong>：僅需 <code>pip install jsonschema</code>（可選，有 fallback）</li>
<li>✅ <strong>漸進式演進</strong>：每個項目都可獨立實施，不破壞現有功能</li>
<li>✅ <strong>延續既有模式</strong>：錯誤分類器 = 新 hook 模組、配置 Schema = 擴展 validate_config.py</li>
</ul>
<hr>
<h2 id="二-計畫的可行性評估">二、計畫的可行性評估</h2>
<h3 id="技術可行性-5-5">技術可行性：⭐⭐⭐⭐⭐（5/5）</h3>
<table>
<tr><th>項目</th><th>技術難度</th><th>工作量估算</th><th>風險評估</th></tr>
<tr><td><strong>項目 1：分散式追蹤</strong></td><td>低（環境變數傳播）</td><td>2-3 小時</td><td>極低（只加欄位不改邏輯）</td></tr>
<tr><td><strong>項目 2：錯誤分類</strong></td><td>中（需解析 HTTP 回應）</td><td>6-8 小時</td><td>中（circuit breaker 狀態管理）</td></tr>
<tr><td><strong>項目 3：Schema 驗證</strong></td><td>中（需寫 13 個 JSON Schema）</td><td>8-10 小時</td><td>低（驗證失敗只影響開發）</td></tr>
<tr><td><strong>項目 4：迴圈偵測</strong></td><td>中（SHA-256 hash + 滑動窗口）</td><td>5-6 小時</td><td>中（誤報可能性）</td></tr>
<tr><td><strong>項目 5：策略引擎</strong></td><td>低（YAML 擴展 + 過濾）</td><td>4-5 小時</td><td>低（不影響現有規則）</td></tr>
<tr><td><strong>項目 6：測試框架</strong></td><td>中（需建立 fixtures）</td><td>10-12 小時</td><td>低（測試補強不破壞生產）</td></tr>
</table>
<p><strong>總工作量</strong>：35-44 小時（約 1 週全職工作）
<strong>技術風險</strong>：✅ 低 — 所有方案都是成熟技術（錯誤重試、circuit breaker、JSON Schema 均有業界標準實作）</p>
<h3 id="依賴關係圖準確性-5-5">依賴關係圖準確性：⭐⭐⭐⭐⭐（5/5）</h3>
<p>方案提出的 3-Phase 實施順序邏輯嚴謹：</p>
<pre><code class="language-plaintext">Phase A（基礎層，0 依賴）
  ├─ 項目 1: 分散式追蹤 ← 無依賴，立即提供可見性
  └─ 項目 3: 配置 Schema ← 無依賴，保護後續配置變更

Phase B（核心改善，依賴 Phase A）
  ├─ 項目 2: 錯誤分類 ← 依賴項目 1 的 trace_id 做錯誤關聯
  └─ 項目 4: 迴圈偵測 ← 依賴項目 1 的 session 追蹤

Phase C（強化層，依賴 Phase B）
  ├─ 項目 5: 策略引擎 ← 依賴項目 3 的 schema 驗證 preset 格式
  └─ 項目 6: 測試框架 ← 依賴項目 2/4 才有東西可測</code></pre>
<p><strong>評估</strong>：✅ 依賴關係合理，可安全按順序實施。</p>
<h3 id="修改範圍評估">修改範圍評估</h3>
<table>
<tr><th>類型</th><th>方案宣稱</th><th>實際驗證</th><th>落差</th></tr>
<tr><td><strong>新建檔案</strong></td><td>14 個</td><td>需驗證（含 13 個 JSON Schema）</td><td>-</td></tr>
<tr><td><strong>修改檔案</strong></td><td>11 個</td><td>✅ 合理（3 個 .ps1 + 6 個 hooks + 3 個 configs）</td><td>0%</td></tr>
<tr><td><strong>測試覆蓋</strong></td><td>306 個測試</td><td>⚠️ 現有僅 199 個測試函數</td><td>-35%</td></tr>
</table>
<p><strong>現實校正</strong>：測試數量可能是 parametrize 展開後的數字，實際測試函數數量為 199 個（分布於 10 個測試檔案）。</p>
<hr>
<h2 id="三-落實的價值分析">三、落實的價值分析</h2>
<h3 id="價值矩陣-影響力-緊迫性-roi">價值矩陣（影響力 × 緊迫性 × ROI）</h3>
<table>
<tr><th>項目</th><th>影響力</th><th>緊迫性</th><th>ROI</th><th>推薦優先級</th></tr>
<tr><td><strong>項目 1：分散式追蹤</strong></td><td>🟢 高（端到端可見性）</td><td>🟢 高（Team 模式已上線）</td><td>⭐⭐⭐⭐⭐</td><td><strong>P0（立即實施）</strong></td></tr>
<tr><td><strong>項目 2：錯誤分類</strong></td><td>🔴 極高（避免盲目重試浪費）</td><td>🟢 高（每小時執行一次）</td><td>⭐⭐⭐⭐⭐</td><td><strong>P0（立即實施）</strong></td></tr>
<tr><td><strong>項目 3：Schema 驗證</strong></td><td>🟡 中（預防配置錯誤）</td><td>🟡 中（已有 12/15 覆蓋）</td><td>⭐⭐⭐⭐</td><td><strong>P1（近期實施）</strong></td></tr>
<tr><td><strong>項目 4：迴圈偵測</strong></td><td>🟡 中（避免浪費配額）</td><td>🟡 低（未觀察到迴圈）</td><td>⭐⭐⭐</td><td><strong>P2（需求驅動）</strong></td></tr>
<tr><td><strong>項目 5：策略引擎</strong></td><td>🟡 中（開發便利性）</td><td>🟡 低（現有規則已足夠）</td><td>⭐⭐⭐</td><td><strong>P2（需求驅動）</strong></td></tr>
<tr><td><strong>項目 6：測試框架</strong></td><td>🟢 高（長期品質保證）</td><td>🟡 低（現有 199 測試已覆蓋核心）</td><td>⭐⭐⭐</td><td><strong>P2（持續改善）</strong></td></tr>
</table>
<h3 id="價值詳細分析">價值詳細分析</h3>
<p>#### 🥇 項目 1：分散式追蹤（最高價值）</p>
<p><strong>現況痛點</strong>：</p>
<ul>
<li>Team 模式每日執行 3 次（08:00, 11:15, 21:15）+ Todoist 模式每小時 2 次</li>
<li>日誌查詢工具（<code>query-logs.ps1</code>）只能靠時間戳推測，無法確定「這次 08:00 摘要為何缺新聞？」</li>
</ul>
<p><strong>價值量化</strong>：</p>
<ul>
<li>🎯 <strong>故障診斷時間</strong>：從 ~15 分鐘（手動比對 5 個 Agent 日誌）→ ~2 分鐘（<code>--trace</code> 過濾）</li>
<li>🎯 <strong>可觀測性提升</strong>：80% → 95%（可追蹤每個 Phase 的完整流程）</li>
<li>🎯 <strong>投入產出比</strong>：2-3 小時實施 / 每次故障節省 13 分鐘 = <strong>第 10 次故障後回本</strong></li>
</ul>
<p><strong>建議</strong>：✅ <strong>立即實施</strong> — 低成本、高回報、無風險。</p>
<hr>
<p>#### 🥇 項目 2：錯誤分類 + API 可用性追蹤（最高影響）</p>
<p><strong>現況痛點</strong>：</p>
<ul>
<li>Todoist API 429（Rate Limit）→ 等 60 秒重試 → 實際應等 Retry-After 指定的秒數</li>
<li>屏東新聞 API 503（暫時故障）→ 下一輪仍盲目重試 → 應直接用快取</li>
<li>Gmail API 401（認證失效）→ 重試一次後失敗 → 應立即停止並告警</li>
</ul>
<p><strong>價值量化</strong>：</p>
<ul>
<li>🎯 <strong>API 配額節省</strong>：減少 ~40% 無效重試（429/500 分類優化）</li>
<li>🎯 <strong>執行時間優化</strong>：Circuit breaker 跳過已知故障 API → 節省 ~30 秒/次</li>
<li>🎯 <strong>可靠性提升</strong>：避免重試風暴（連續 3 次失敗自動降級到快取）</li>
<li>🎯 <strong>告警精準度</strong>：401/403 立即通知（不浪費重試）→ 減少 ~50% 無意義告警</li>
</ul>
<p><strong>ROI 計算</strong>：</p>
<ul>
<li>每日 47 次 API 呼叫（3 次摘要 × 5 APIs + 22 次 Todoist × 1 API）</li>
<li>假設 5% 失敗率 → 每日 ~2.35 次失敗</li>
<li>精準重試節省 ~1 分鐘/次 → <strong>每日節省 ~2.4 分鐘</strong></li>
<li>實施成本 6-8 小時 / 每日節省 2.4 分鐘 = <strong>第 200 天回本</strong>（可接受）</li>
</ul>
<p><strong>建議</strong>：✅ <strong>立即實施</strong> — 影響最大，符合專案「自動化運維」核心目標。</p>
<hr>
<p>#### 🥈 項目 3：配置 Schema 驗證（預防性價值）</p>
<p><strong>現況痛點</strong>：</p>
<ul>
<li><code>frequency-limits.yaml</code> 曾從 v2 → v3（新增 <code>execution_order</code>），無自動遷移</li>
<li><code>timeouts.yaml</code>、<code>creative-game-mode.yaml</code> 等 3 個 YAML 完全無驗證</li>
<li>配置錯誤在排程執行時才發現（延遲反饋）</li>
</ul>
<p><strong>價值量化</strong>：</p>
<ul>
<li>🎯 <strong>開發體驗</strong>：配置錯誤從「運行時發現」→「保存時驗證」</li>
<li>🎯 <strong>生產穩定性</strong>：避免因配置錯誤導致排程失敗（歷史上未發生，但風險存在）</li>
<li>🎯 <strong>遷移安全性</strong>：未來配置升級可自動遷移（避免手動改壞）</li>
</ul>
<p><strong>建議</strong>：✅ <strong>近期實施</strong> — 工作量合理（8-10 小時），預防性價值高。</p>
<hr>
<p>#### 🥉 項目 4：迴圈偵測（需求驅動）</p>
<p><strong>現況痛點</strong>：</p>
<ul>
<li><strong>未觀察到實際迴圈問題</strong>（專案運行數月，日誌無重複 API 呼叫記錄）</li>
<li>現有 <code>research-registry.json</code> 已防止跨 session 研究主題重複</li>
</ul>
<p><strong>價值質疑</strong>：</p>
<ul>
<li>🤔 <strong>真實需求不明確</strong>：若 Agent 陷入迴圈，<code>post_tool_logger.py</code> 會記錄所有呼叫，人工檢查可行</li>
<li>🤔 <strong>誤報風險</strong>：正常情況下重複讀取 <code>SKILL_INDEX.md</code> 3 次（載入 + 路由 + 驗證）可能誤觸閾值</li>
<li>🤔 <strong>ROI 偏低</strong>：5-6 小時實施 / 未知問題頻率 = <strong>難以估算回報</strong></li>
</ul>
<p><strong>建議</strong>：⏸️ <strong>延後實施</strong> — 等待真實痛點出現後再考慮。若實施，建議先啟用「警告模式」（只記錄不阻斷）觀察 1-2 週。</p>
<hr>
<p>#### 🥉 項目 5：分層安全策略引擎（便利性優化）</p>
<p><strong>現況痛點</strong>：</p>
<ul>
<li>開發時手動註解 hook-rules.yaml 規則（例如測試 <code>&gt; nul</code> 時）</li>
<li>無法針對排程（嚴格）vs 互動（寬鬆）自動調整</li>
</ul>
<p><strong>價值量化</strong>：</p>
<ul>
<li>🎯 <strong>開發便利性</strong>：切換環境變數即可調整規則（vs 手動註解 YAML）</li>
<li>🎯 <strong>安全性</strong>：critical 規則永遠不可停用（防止誤操作）</li>
</ul>
<p><strong>建議</strong>：⏸️ <strong>延後實施</strong> — 現有手動註解已可滿足需求，4-5 小時投入的便利性提升有限。</p>
<hr>
<p>#### 🥉 項目 6：結構化測試 + 錄製/重播（長期投資）</p>
<p><strong>現況痛點</strong>：</p>
<ul>
<li>現有 199 個測試已覆蓋核心（hooks 160 + skills 27 + 其他 12）</li>
<li>無整合測試（Phase 1→2 管線）、無 golden 測試（配置穩定性）</li>
</ul>
<p><strong>價值量化</strong>：</p>
<ul>
<li>🎯 <strong>回歸測試效率</strong>：API 錄製/重播 → 無需真實 Todoist token 即可測試</li>
<li>🎯 <strong>信心提升</strong>：配置修改前可跑 golden 測試確認無破壞</li>
<li>🎯 <strong>長期維護</strong>：測試即文檔（fixtures 即 API 契約範例）</li>
</ul>
<p><strong>建議</strong>：⏸️ <strong>持續改善</strong> — 價值高但非緊急，可分批實施（每次新增功能時補測試）。</p>
<hr>
<h2 id="四-推薦實施路線圖">四、推薦實施路線圖</h2>
<h3 id="phase-1-立即行動-2-週內完成">🚀 Phase 1（立即行動，2 週內完成）</h3>
<table>
<tr><th>項目</th><th>實施順序</th><th>工作量</th><th>驗收標準</th></tr>
<tr><td><strong>項目 1：分散式追蹤</strong></td><td>Week 1 Day 1-2</td><td>3 小時</td><td><code>query-logs.ps1 --trace &lt;id&gt;</code> 可過濾完整 Phase 1+2 日誌</td></tr>
<tr><td><strong>項目 2：錯誤分類</strong></td><td>Week 1 Day 3-5</td><td>8 小時</td><td>429 自動延遲 Retry-After 秒數；401 停止重試並告警</td></tr>
<tr><td><strong>項目 3：Schema 驗證</strong></td><td>Week 2 Day 1-5</td><td>10 小時</td><td>所有 15 個 YAML 有 JSON Schema；validate_config.py 全通過</td></tr>
</table>
<p><strong>預期產出</strong>：</p>
<ul>
<li>新增 3 個 Python 模組（<code>error_classifier.py</code>, <code>api_availability.py</code>, 13 個 <code>.schema.json</code>）</li>
<li>修改 11 個檔案（3 個 .ps1 + 6 個 hooks + 3 個 configs）</li>
<li>新增 ~50 個測試案例</li>
</ul>
<p><strong>投入總計</strong>：21 小時（~3 個全職工作日）</p>
<hr>
<h3 id="phase-2-需求驅動-3-6-個月內">🔄 Phase 2（需求驅動，3-6 個月內）</h3>
<p><strong>觸發條件</strong>：</p>
<ul>
<li><strong>項目 4（迴圈偵測）</strong>：觀察到 2+ 次 Agent 重複呼叫同一 API 的實際案例</li>
<li><strong>項目 5（策略引擎）</strong>：手動註解規則次數 ≥10 次/月</li>
<li><strong>項目 6（測試框架）</strong>：配置破壞性變更導致生產故障 1+ 次</li>
</ul>
<p><strong>建議</strong>：保持方案文件（<code>GeminiCli借鏡方案.md</code>），當痛點顯現時立即實施。</p>
<hr>
<h2 id="五-風險與緩解措施">五、風險與緩解措施</h2>
<h3 id="已識別風險">已識別風險</h3>
<table>
<tr><th>風險</th><th>嚴重性</th><th>緩解措施</th></tr>
<tr><td><strong>Circuit breaker 誤判</strong>（健康 API 被標記為 open）</td><td>中</td><td>1. half_open 狀態定期試探；2. cooldown 時間設短（5 分鐘）；3. 手動重置腳本</td></tr>
<tr><td><strong>迴圈偵測誤報</strong>（正常重複操作被攔截）</td><td>中</td><td>1. 閾值設寬鬆（5 次同一呼叫）；2. 警告模式運行 1-2 週調整；3. 白名單機制</td></tr>
<tr><td><strong>Schema 驗證阻斷開發</strong>（新配置格式被拒絕）</td><td>低</td><td>1. fallback 到舊驗證邏輯；2. 開發環境可跳過驗證；3. 錯誤訊息清晰指引修正</td></tr>
<tr><td><strong>遷移系統破壞現有配置</strong>（v2→v3 遷移錯誤）</td><td>低</td><td>1. dry-run 模式預覽變更；2. 遷移前自動備份；3. Git 版本控制隨時回復</td></tr>
</table>
<h3 id="實施前置條件">實施前置條件</h3>
<p>✅ <strong>已具備</strong>：</p>
<ul>
<li>Python 3.8+（現有）</li>
<li>PowerShell 7（現有）</li>
<li>Git 版本控制（現有）</li>
<li>現有測試框架（pytest）</li>
</ul>
<p>⚠️ <strong>需補充</strong>：</p>
<ul>
<li><code>pip install jsonschema</code>（可選，有 fallback）</li>
<li>測試覆蓋率報告工具（<code>pytest-cov</code>）</li>
</ul>
<hr>
<h2 id="六-結論與建議">六、結論與建議</h2>
<h3 id="綜合評分">綜合評分</h3>
<table>
<tr><th>維度</th><th>評分</th><th>說明</th></tr>
<tr><td><strong>問題識別準確度</strong></td><td>⭐⭐⭐⭐⭐ 95/100</td><td>5 個痛點均真實存在</td></tr>
<tr><td><strong>技術可行性</strong></td><td>⭐⭐⭐⭐⭐ 100/100</td><td>無新依賴，漸進式演進</td></tr>
<tr><td><strong>價值/成本比</strong></td><td>⭐⭐⭐⭐ 80/100</td><td>項目 1-3 高 ROI，項目 4-6 需求驅動</td></tr>
<tr><td><strong>實施風險</strong></td><td>⭐⭐⭐⭐ 低風險</td><td>所有方案可獨立回退</td></tr>
</table>
<p><strong>總評</strong>：⭐⭐⭐⭐⭐ <strong>92/100 — 優秀方案，強烈推薦分階段實施</strong></p>
<h3 id="最終建議">最終建議</h3>
<ol>
<li>✅ <strong>立即實施 Phase 1</strong>（項目 1-3）— 21 小時投入可獲得顯著的可觀測性、可靠性、安全性提升</li>
<li>⏸️ <strong>延後 Phase 2</strong>（項目 4-6）— 等待實際痛點出現，避免過度工程</li>
<li>📋 <strong>保留方案文件</strong> — 作為未來優化的 ready-to-implement 藍圖</li>
<li>🔄 <strong>定期評估</strong>（每季度）— 檢視項目 4-6 的觸發條件是否滿足</li>
</ol>
<h3 id="修正建議">修正建議</h3>
<p>方案文件需微調以下 2 處：</p>
<ul>
<li>配置驗證覆蓋率：「7/13」→「12/15」</li>
<li>測試數量澄清：「306 個測試」應註明包含 parametrize 展開（實際測試函數 199 個）</li>
</ul>
<hr>
<h2 id="附錄-參考資料">附錄：參考資料</h2>
<ul>
<li><strong>Gemini CLI 原始碼</strong>：https://github.com/google-gemini/gemini-cli</li>
<li><strong>本專案架構文件</strong>：<code>CLAUDE.md</code>, <code>MEMORY.md</code></li>
<li><strong>現有測試覆蓋</strong>：10 個測試檔案，199 個測試函數（hooks 160 + skills 27）</li>
<li><strong>配置清單</strong>：15 個 YAML（config/ 目錄）</li>
</ul>

      </div>

      <a href="../" class="back-link">&larr; 返回首頁</a>
    </article>
  </main>

  <button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" aria-label="回到頂部">&uarr;</button>

  <footer>
    <div class="container">
      <p>Powered by RAG Knowledge Base</p>
    </div>
  </footer>
  <script>
    function toggleTheme(){const b=document.body;b.classList.toggle('dark');localStorage.setItem('theme',b.classList.contains('dark')?'dark':'light')}
    if(localStorage.getItem('theme')==='dark')document.body.classList.add('dark');
    window.addEventListener('scroll',function(){
      const prog=document.getElementById('readingProgress');
      const btn=document.getElementById('backToTop');
      const h=document.documentElement.scrollHeight-window.innerHeight;
      const pct=h>0?(window.scrollY/h)*100:0;
      prog.style.width=pct+'%';
      btn.classList.toggle('visible',window.scrollY>300);
    });
  </script>
</body>
</html>
