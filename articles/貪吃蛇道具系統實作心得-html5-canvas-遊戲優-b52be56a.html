<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="貪吃蛇道具系統實作心得 — HTML5 Canvas 遊戲優化">
  <title>貪吃蛇道具系統實作心得 — HTML5 Canvas 遊戲優化 | 知識庫</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="reading-progress" id="readingProgress"></div>
  <header>
    <div class="container">
      <a href="../" class="logo">知識庫</a>
      <nav>
        <a href="../#buddhism">佛學</a>
        <a href="../#thinking">思維方法</a>
        <a href="../#ai">AI技術</a>
        <a href="../#claude">Claude Code</a>
        <a href="../#game">遊戲</a>
      </nav>
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="切換深色模式">
        <span class="theme-icon">&#9680;</span>
      </button>
    </div>
  </header>

  <main class="container">
    <article>
      <div class="article-header">
        <span class="category-badge category-game">遊戲開發</span>
        <h1>貪吃蛇道具系統實作心得 — HTML5 Canvas 遊戲優化</h1>
        <div class="article-meta">
          <span class="date">2026-02-16</span>
          <div class="tags"><span class="tag">遊戲設計</span><span class="tag">HTML5</span><span class="tag">Canvas</span><span class="tag">貪吃蛇</span><span class="tag">道具系統</span><span class="tag">JavaScript</span></div>
        </div>
      </div>

      <details class="article-toc" open>
        <summary>目錄</summary>
        <ol>
          <li><a href="#貪吃蛇道具系統實作">貪吃蛇道具系統實作</a></li>  <li><a href="#優化方向">優化方向</a></li>  <li><a href="#四種道具設計">四種道具設計</a></li>  <li><a href="#技術實作要點">技術實作要點</a></li>  <li><a href="#顏色渲染修正">顏色渲染修正</a></li>  <li><a href="#平衡性考量">平衡性考量</a></li>
        </ol>
      </details>

      <div class="article-content">
        <h2 id="貪吃蛇道具系統實作">貪吃蛇道具系統實作</h2>
<h3 id="優化方向">優化方向</h3>
<p>玩法機制擴展 — 在經典貪吃蛇基礎上加入 4 種特殊道具食物，增加遊戲深度與策略性。</p>
<h3 id="四種道具設計">四種道具設計</h3>
<ol>
<li><strong>冰凍減速（FREEZE）</strong> — 藍色 ❄️</li>
</ol>
<p>   - 效果：蛇移動速度降低 50%，持續約 25 個遊戲 tick
   - 加分：+2 分
   - 用途：給玩家喘息空間，適合高速階段使用</p>
<ol>
<li><strong>毒食物縮短（POISON）</strong> — 綠色 ☠️</li>
</ol>
<p>   - 效果：蛇身縮短 2 節
   - 加分：+5 分（高風險高回報）
   - 限制：蛇長度 &lt; 4 時不會生成，改為冰凍</p>
<ol>
<li><strong>傳送門（PORTAL）</strong> — 紫色 ✱</li>
</ol>
<p>   - 效果：蛇頭隨機傳送到空白格子
   - 加分：+2 分
   - 安全機制：最多嘗試 100 次尋找空位，避免無窮迴圈</p>
<ol>
<li><strong>護盾（SHIELD）</strong> — 白色 ☆</li>
</ol>
<p>   - 效果：抵擋一次自身碰撞（不可疊加）
   - 加分：無
   - 視覺：蛇頭周圍顯示金色光環</p>
<h3 id="技術實作要點">技術實作要點</h3>
<ul>
<li><strong>生成機制</strong>：吃到普通食物時 20% 機率觸發，8 tick 冷卻防止過於頻繁</li>
<li><strong>TTL 機制</strong>：道具食物存在 40 tick 後自動消失，避免畫面堆積</li>
<li><strong>isOccupied() 統一碰撞檢查</strong>：避免食物重疊生成</li>
<li><strong>音效</strong>：使用 Web Audio API 的 oscillator 程序化生成，無需外部音檔</li>
<li><strong>視覺效果</strong>：發光脈動、符號旋轉（傳送門）、護盾光環、冰凍邊框</li>
<li><strong>HUD 狀態顯示</strong>：右上角即時顯示冰凍/護盾狀態</li>
</ul>
<h3 id="顏色渲染修正">顏色渲染修正</h3>
<p>使用 hex 色碼（如 <code>#38bdf8</code>）時，不能用 <code>rgb().replace()</code> 轉 rgba。改用 <code>ctx.globalAlpha</code> 控制透明度更通用。</p>
<h3 id="平衡性考量">平衡性考量</h3>
<ul>
<li>毒食物分數最高（+5）但有蛇長限制</li>
<li>護盾不可疊加，防止無敵</li>
<li>冷卻機制防止道具氾濫</li>
<li>傳送門有隨機性風險（可能傳到危險位置）</li>
</ul>

      </div>

      <a href="../" class="back-link">&larr; 返回首頁</a>
    </article>
  </main>

  <button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" aria-label="回到頂部">&uarr;</button>

  <footer>
    <div class="container">
      <p>Powered by RAG Knowledge Base</p>
    </div>
  </footer>
  <script>
    function toggleTheme(){const b=document.body;b.classList.toggle('dark');localStorage.setItem('theme',b.classList.contains('dark')?'dark':'light')}
    if(localStorage.getItem('theme')==='dark')document.body.classList.add('dark');
    window.addEventListener('scroll',function(){
      const prog=document.getElementById('readingProgress');
      const btn=document.getElementById('backToTop');
      const h=document.documentElement.scrollHeight-window.innerHeight;
      const pct=h>0?(window.scrollY/h)*100:0;
      prog.style.width=pct+'%';
      btn.classList.toggle('visible',window.scrollY>300);
    });
  </script>
</body>
</html>
