<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Breakout (打磚塊) v1.0 創建心得 — 粒子爆炸 + 8-bit 音效 + 道具系統">
  <title>Breakout (打磚塊) v1.0 創建心得 — 粒子爆炸 + 8-bit 音效 + 道具系統 | 知識庫</title>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="reading-progress" id="readingProgress"></div>
  <header>
    <div class="container">
      <a href="../" class="logo">知識庫</a>
      <nav>
        <a href="../#buddhism">佛學</a>
        <a href="../#thinking">思維方法</a>
        <a href="../#ai">AI技術</a>
        <a href="../#claude">Claude Code</a>
        <a href="../#game">遊戲</a>
      </nav>
      <button class="theme-toggle" onclick="toggleTheme()" aria-label="切換深色模式">
        <span class="theme-icon">&#9680;</span>
      </button>
    </div>
  </header>

  <main class="container">
    <article>
      <div class="article-header">
        <span class="category-badge category-game">遊戲開發</span>
        <h1>Breakout (打磚塊) v1.0 創建心得 — 粒子爆炸 + 8-bit 音效 + 道具系統</h1>
        <div class="article-meta">
          <span class="date">2026-02-18</span>
          <span class="reading-time">2 分鐘閱讀</span>
          <div class="tags"><span class="tag">遊戲設計</span><span class="tag">HTML5</span><span class="tag">Canvas</span><span class="tag">碰撞偵測</span><span class="tag">Breakout</span><span class="tag">打磚塊</span><span class="tag">粒子系統</span><span class="tag">Web Audio API</span></div>
        </div>
      </div>

      <details class="article-toc" open>
        <summary>目錄</summary>
        <ol>
          <li><a href="#概述">概述</a></li><li><a href="#核心技術要點">核心技術要點</a></li>  <li><a href="#碰撞偵測-圓形-aabb">碰撞偵測（圓形+AABB）</a></li>  <li><a href="#球拍反彈角度映射">球拍反彈角度映射</a></li>  <li><a href="#固定時間步長遊戲迴圈">固定時間步長遊戲迴圈</a></li>  <li><a href="#粒子系統-物件池">粒子系統（物件池）</a></li>  <li><a href="#web-audio-api-8-bit-音效">Web Audio API 8-bit 音效</a></li>  <li><a href="#道具系統">道具系統</a></li>  <li><a href="#難度階梯">難度階梯</a></li><li><a href="#設計決策">設計決策</a></li><li><a href="#易踩的坑">易踩的坑</a></li>
        </ol>
      </details>

      <div class="article-content">
        <h1>Breakout (打磚塊) v1.0 創建心得</h1>
<h2 id="概述">概述</h2>
<p>從零創建經典 Breakout 打磚塊遊戲，HTML5 Canvas 純程式化繪製，含粒子爆炸效果、Web Audio API 8-bit 音效合成、三種道具系統。</p>
<h2 id="核心技術要點">核心技術要點</h2>
<h3 id="碰撞偵測-圓形-aabb">碰撞偵測（圓形+AABB）</h3>
<ul>
<li>球為圓形，磚塊為矩形，使用 circle-rect collision</li>
<li>找最近點計算距離：<code>closestX = clamp(ball.x, brick.x, brick.x + brick.w)</code></li>
<li>判定碰撞方向：比較 overlapX vs overlapY，決定反彈軸</li>
<li>穿透修正：碰撞後立即將球推出磚塊範圍</li>
</ul>
<h3 id="球拍反彈角度映射">球拍反彈角度映射</h3>
<ul>
<li>擊球位置 hitPos = (ball.x - paddle.x) / paddleW，範圍 0~1</li>
<li>映射到角度 -150 到 -30 度（弧度計算）</li>
<li>左端打出向左上方，右端打出向右上方，中間垂直向上</li>
</ul>
<h3 id="固定時間步長遊戲迴圈">固定時間步長遊戲迴圈</h3>
<ul>
<li>requestAnimationFrame + accumulator 模式</li>
<li>固定 dt = 1000/60（~16.67ms）</li>
<li>dt &gt; 200ms 時 clamp，防止切頁回來的 spiral of death</li>
</ul>
<h3 id="粒子系統-物件池">粒子系統（物件池）</h3>
<ul>
<li>120 個粒子預分配，零 GC 壓力</li>
<li>active flag 標記啟用/回收</li>
<li>重力模擬（vy += 0.08）、漸變透明度、大小衰減</li>
<li>磚塊碎裂時生成 8 個同色粒子，球拍擊球生成 3 個白色粒子</li>
</ul>
<h3 id="web-audio-api-8-bit-音效">Web Audio API 8-bit 音效</h3>
<ul>
<li>方波（square）用於球拍擊球、過關旋律</li>
<li>三角波（triangle）用於磚塊碎裂（頻率隨行號遞增：300+row*60）</li>
<li>鋸齒波（sawtooth）用於失去生命和遊戲結束</li>
<li>正弦波（sine）用於牆壁反彈</li>
<li>exponentialRampToValueAtTime 實現 ADSR 包絡</li>
</ul>
<h3 id="道具系統">道具系統</h3>
<ul>
<li>12% 機率在磚塊碎裂時掉落菱形道具</li>
<li>Wide（W）：球拍加寬 1.3 倍（上限 1.5 倍原寬）</li>
<li>Multi（M）：每顆球分裂成 3 顆（±0.4 弧度偏移）</li>
<li>Slow（S）：球速降為 0.7 倍</li>
</ul>
<h3 id="難度階梯">難度階梯</h3>
<ul>
<li>球速隨磚塊消除遞增：speedMult = 1 + destroyed/total * 0.5</li>
<li>關卡遞增：每關 +0.15 速度加成</li>
<li>Level 3+ 頂部 2 行磚塊 HP=2</li>
</ul>
<h2 id="設計決策">設計決策</h2>
<ul>
<li>7 行 10 列磚塊陣列，每行顏色與分數不同（紅7分→紫1分）</li>
<li>Combo 系統：連續擊碎每 5 個增加 0.5 倍分數加成</li>
<li>5 狀態機：MENU/PLAYING/PAUSED/GAMEOVER/LEVELCLEAR</li>
<li>響應式設計：scale 因子統一縮放所有座標</li>
<li>localStorage 持久化最高分</li>
</ul>
<h2 id="易踩的坑">易踩的坑</h2>
<ul>
<li>球速正規化：每幀更新球速時必須先計算 currentSpeed 再正規化方向向量</li>
<li>多球模式下 ballsToRemove 必須反向遍歷刪除，避免 index shift</li>
<li>觸控事件必須 e.preventDefault() 且 passive:false，否則頁面跟著滾動</li>
</ul>

      </div>

      <nav class="article-nav"><a href="ai-世界模型world-models完整指南從-je-2e2513be.html" class="nav-prev"><span class="nav-label">&larr; 上一篇</span><span class="nav-title">AI 世界模型（World Models）完整指南：從 JEPA 到 Genie 的架構演進、訓練方法與應用前景（2026）</span></a><a href="html5-canvas-遊戲迴圈game-loop模式-28664d2c.html" class="nav-next"><span class="nav-label">下一篇 &rarr;</span><span class="nav-title">HTML5 Canvas 遊戲迴圈（Game Loop）模式與幀率控制完整指南（2026）</span></a></nav>

      <a href="../" class="back-link">&larr; 返回首頁</a>
    </article>
  </main>

  <button class="back-to-top" id="backToTop" onclick="window.scrollTo({top:0,behavior:'smooth'})" aria-label="回到頂部">&uarr;</button>

  <footer>
    <div class="container">
      <p>Powered by RAG Knowledge Base</p>
    </div>
  </footer>
  <script>
    function toggleTheme(){const b=document.body;b.classList.toggle('dark');localStorage.setItem('theme',b.classList.contains('dark')?'dark':'light')}
    if(localStorage.getItem('theme')==='dark')document.body.classList.add('dark');
    window.addEventListener('scroll',function(){
      const prog=document.getElementById('readingProgress');
      const btn=document.getElementById('backToTop');
      const h=document.documentElement.scrollHeight-window.innerHeight;
      const pct=h>0?(window.scrollY/h)*100:0;
      prog.style.width=pct+'%';
      btn.classList.toggle('visible',window.scrollY>300);
    });
  </script>
</body>
</html>
